(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))y(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&y(n)}).observe(document,{childList:!0,subtree:!0});function d(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function y(t){if(t.ep)return;t.ep=!0;const o=d(t);fetch(t.href,o)}})();const $="modulepreload",x=function(c){return"/"+c},U={},D=function(m,d,y){let t=Promise.resolve();if(d&&d.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));t=Promise.allSettled(d.map(e=>{if(e=x(e),e in U)return;U[e]=!0;const a=e.endsWith(".css"),v=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${v}`))return;const i=document.createElement("link");if(i.rel=a?"stylesheet":$,a||(i.as="script"),i.crossOrigin="",i.href=e,r&&i.setAttribute("nonce",r),document.head.appendChild(i),a)return new Promise((L,B)=>{i.addEventListener("load",L),i.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${e}`)))})}))}function o(n){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n}return t.then(n=>{for(const r of n||[])r.status==="rejected"&&o(r.reason);return m().catch(o)})};async function F(){const{PDFDocument:c}=await D(async()=>{const{PDFDocument:e}=await import("pdf-lib");return{PDFDocument:e}},[]),{jsPDF:m}=window.jspdf,d=document.getElementById("name").value,y=document.getElementById("email").value,t=document.getElementById("contact").value,o=document.getElementById("query").value,n=document.getElementById("notRobot").checked,r=document.getElementById("fileUpload");if(!n){alert("Please confirm you are not a robot.");return}if(r.files.length===0){alert("Please select at least one file to upload.");return}try{const e=await c.create(),a=new m;a.setFontSize(16),a.text("IRB Submission Form",20,20),a.setFontSize(12),a.text(`Name: ${d}`,20,40),a.text(`Email: ${y}`,20,50),a.text(`Contact: ${t}`,20,60),a.text(`Query: ${o}`,20,70);const v=a.output("arraybuffer"),i=await c.load(v);(await e.copyPages(i,i.getPageIndices())).forEach(P=>e.addPage(P));let B=`${d} ${y} ${t} ${o} `;for(let P=0;P<r.files.length;P++){const s=r.files[P],u=s.type.toLowerCase();if(u.includes("image")){const g=await s.arrayBuffer();let l;if(u.includes("png"))l=await e.embedPng(g);else if(u.includes("jpeg")||u.includes("jpg"))l=await e.embedJpg(g);else{console.warn(`Unsupported image type: ${u}`);continue}const b=e.addPage(),{width:p,height:h}=l.size(),f=b.getSize().width,R=b.getSize().height,E=Math.min(f/p,R/h);b.drawImage(l,{x:(f-p*E)/2,y:(R-h*E)/2,width:p*E,height:h*E})}else if(u.includes("pdf")){const g=await s.arrayBuffer(),l=await c.load(g);(await e.copyPages(l,l.getPageIndices())).forEach(p=>e.addPage(p))}else if(u.includes("word")||s.name.endsWith(".doc")||s.name.endsWith(".docx")){const g=e.addPage(),{helvetica:l}=await e.embedFont(c.Standard.Helvetica);g.drawText("Word document attached: "+s.name,{x:50,y:g.getSize().height-100,size:12,font:l});const b=await s.arrayBuffer();B+=wordText+" ";const p=new Blob([await s.arrayBuffer()],{type:u}),h=URL.createObjectURL(p),f=document.createElement("a");f.href=h,f.download="original-"+s.name,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(h)}}const I=await e.save(),O=new Blob([I],{type:"application/pdf"}),S=URL.createObjectURL(O),w=document.createElement("a");w.href=S,w.download="submission-package.pdf",document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(S)}catch(e){console.error("Error processing files:",e),alert("Error processing files. Please try again.")}}function j(c){c.preventDefault(),F()}window.handleFileSubmission=j;
